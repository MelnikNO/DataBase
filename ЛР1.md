# Лабораторная работа 1

## Задание 1. Используя справочные материалы по MySQL Workbench, опишите назначение пунктов меню Management (“Управление”), “Instance” (“Экземпляр БД”) и “Performance” (“Производительность”). В качестве примера описания используйте следующий пример для раздела Management (его описывать не надо)

### Решение:
**Раздел «Management»:**
1.	Раздел «Server Status». В разделе отображается общая информация о сервере и подключении к нему. Информация логически сгруппирована. Можно выделить следующие группы: 
-	Общая информация (например, название хоста, номер порта, версия БД).
-	Настройки сервера (например, включен ли брандмауэр, используется ли SSL)
- Каталоги сервера
-	Сводка по используемым ресурсам компьютера (ОЗУ, процессор и т. д.)
-	Настройки соединения SSL (если SSL включена).
2.	Раздел «Client Connections». В этом разделе отображается список активных соединений к серверу MySQL. Администраторы могут видеть, какие пользователи подключены, какие запросы они выполняют, и при необходимости завершать соединения, чтобы освободить ресурсы или устранить проблемы.
3.	Раздел «Users and Privileges». Этот инструмент позволяет управлять учетными записями пользователей MySQL и их правами доступа к базам данных. Администраторы могут добавлять новых пользователей, изменять их пароли, назначать права на выполнение определенных действий и удалять пользователей. Можно выделить такие группы
-	Login. Относится к возможности пользователя входить в систему MySQL.
-	Account Limits. Помогает контролировать использование ресурсов сервера и повышает безопасность, ограничивая возможности пользователей.
-	Administrative Roles. Упрощает управление правами доступа, позволяя назначать пользователям наборы прав вместо индивидуальной настройки для каждого действия.
-	Schema Privileges. Позволяет детализированно управлять доступом к данным, обеспечивая безопасность и контроль над тем, кто может выполнять какие операции с базами данных.
4.	Раздел «Status and System Variables». Этот раздел предоставляет информацию о текущих системных переменных MySQL и их значениях. Администраторы могут видеть настройки конфигурации сервера, что позволяет им оптимизировать работу базы данных и настраивать параметры в соответствии с требованиями приложения.
5.	Раздел «Data Export». Инструмент для создания резервных копий баз данных или отдельных таблиц в формате SQL или других форматов. Это позволяет администраторам сохранять данные для дальнейшего восстановления или переноса на другие серверы.
6.	Раздел «Data import/Restore». Этот инструмент используется для восстановления данных из резервных копий или импорта данных из файлов в базу данных MySQL. Администраторы могут загружать данные из различных форматов, что упрощает процесс миграции и обновления данных.

**Раздел «Instance»:**
1.	Startup / Shutdown. Этот раздел позволяет администраторам управлять состоянием MySQL-сервера. Они могут запускать, останавливать или перезапускать сервер.
2.	Server Logs. Здесь можно просматривать различные журналы MySQL, такие как журнал ошибок, журнал медленных запросов и другие системные журналы. Эти журналы помогают администраторам отслеживать проблемы с сервером и анализировать производительность.
3.	Options File. Этот инструмент позволяет редактировать конфигурационный файл MySQL (my.cnf или my.ini), в котором хранятся настройки сервера. Администраторы могут изменять параметры конфигурации для оптимизации работы сервера в зависимости от конкретных требований и условий эксплуатации. Можно выделить такие группы:
-	General. Позволяет настроить основные характеристики работы MySQL-сервера.
- Logging. Управляет тем, как и где MySQL будет записывать информацию о своей деятельности.
-	InnoDB. Оптимизация работы с InnoDB для повышения скорости обработки запросов и управления памятью.
-	Networking. Управляет сетевыми аспектами работы сервера, включая доступ клиентов и производительность сетевых операций.
-	Advanced. Позволяет опытным администраторам настраивать сервер под специфические требования и сценарии использования.
-	Other. Предоставляет возможность настройки дополнительных функций MySQL.
-	Security. Увеличивает уровень безопасности MySQL-сервера и защищает данные от несанкционированного доступа.
-	Replication. Позволяет настраивать и управлять процессом репликации данных между различными серверами.
-	MyISAM. Оптимизация работы с MyISAM для повышения производительности запросов на чтение.
-	Performance. Помогает добиться максимальной производительности при работе с базами данных.

**Раздел «Performance»:**
1.	Dashboard. Предоставляет визуальную информацию о производительности сервера MySQL в реальном времени, включая использование CPU, памяти и активные соединения. Позволяет быстро оценивать состояние системы. Можно выделить такие группы:
- Network Status. Позволяет отслеживать загрузку сетевых ресурсов, выявлять возможные проблемы с подключениями и анализировать, сколько клиентов одновременно подключены к серверу.
-	MySQL Status. Позволяет отслеживать общую производительность сервера и выявлять узкие места в обработке запросов. Администраторы могут использовать эту информацию для оптимизации запросов и настройки параметров сервера, чтобы улучшить общую эффективность работы базы данных.
-	InnoDB Status. Позволяет анализировать производительность хранилища InnoDB и выявлять потенциальные проблемы с блокировками или недостатком ресурсов.
2.	Performance Reports. Генерирует отчеты о производительности на основе собранных данных за определенный период времени. Помогает выявлять узкие места и оптимизировать производительность базы данных.
3.	Performance Schema Setup. Позволяет настраивать параметры схемы производительности MySQL, которая предоставляет детализированную информацию о работе запросов и ресурсах сервера для глубокого анализа производительности.

---

## Задание 2. Создать и настроить новую базу данных simpledb.
### Решение:
![code11](https://github.com/MelnikNO/DataBase/blob/main/screen/21.png)
![code11](https://github.com/MelnikNO/DataBase/blob/main/screen/22.png)
 
---

## Задание 3 Скопируйте запрос, соответствующий созданию этой таблицы и вставьте его в отчет по выполнению этой лабораторной работы
### Решение:
![code11](https://github.com/MelnikNO/DataBase/blob/main/screen/3.png)

**Запрос:**
`
CREATE DATABASE `simpledb` /*!40100 DEFAULT CHARACTER SET utf8mb3 */ /*!80016 DEFAULT ENCRYPTION='N' */;
`

---

## Задание 4
## Добавьте несколько примеров-записей в созданную таблицу. Для этого необходимо кликнуть на название таблицы левой кнопкой мыши и выбрать пиктограмму, где изображена таблица и молния (см. изображение ниже).

### Решение:
**SQL – запрос:**

>INSERT INTO `simpledb`.`users` (`id`, `name`, `email`) VALUES ('1', 'robbit', 'rob333@example.com');
INSERT INTO `simpledb`.`users` (`id`, `name`, `email`) VALUES ('2', 'grid', 'grrriinch@example.com');
INSERT INTO `simpledb`.`users` (`id`, `name`, `email`) VALUES ('3', 'Ben', 'flaggg@exc.com');

![code11](https://github.com/MelnikNO/DataBase/blob/main/screen/4.png)

---

## Задание 5
## Дополните таблицу users так, чтобы получилась таблица со следующими полями и параметрами:
    1. id  int pk, not null
    2. name varchar(50)
    3. email varchar(45)
    4. gender ENUM(‘M’, ‘F’)
    5. bday Date
    6. postal_code varchar(10)
    7. rating float
    8. created TIMESTAMP CURRENT_TIMESTAMP()

## Замечание 1
Прочитайте про тип ENUM в документации по БД или в русскоязычном руководстве.

## Замечание 2
Тип данных у поля created - TIMESTAMP, значение по умолчанию CURRENT_TIMESTAMP(). 
В отчете по ЛР опишите, что это означает, прочитав в документации или экспериментально определив.

## Замечание 3
Определите самостоятельно какие поля могут быть NULL и будут иметь это значение в качестве значения по умолчанию, представив себе пользователя, который не очень хочет делиться персонализированной информацией.
Отразите это в отчёте.

### Решение:
**Запрос:**
> ALTER TABLE `simpledb`.`users` 
ADD COLUMN `rating` FLOAT NULL AFTER `email`,
ADD COLUMN `gender` ENUM('M', 'F') NULL AFTER `rating`,
ADD COLUMN `bday` DATE NULL AFTER `gender`,
ADD COLUMN `postal_code` VARCHAR(10) NULL AFTER `bday`,
ADD COLUMN `created` TIMESTAMP NULL AFTER `postal_code`,
CHANGE COLUMN `name` `name` VARCHAR(50) NOT NULL ,
ADD UNIQUE INDEX `email_UNIQUE` (`email` ASC) VISIBLE,
DROP INDEX `userscol1_UNIQUE` ;
;

![code11](https://github.com/MelnikNO/DataBase/blob/main/screen/51.png)
 
### Замечание 2:
Поле created: Поле created имеет тип данных TIMESTAMP, и значение по умолчанию CURRENT_TIMESTAMP() означает, что при создании новой записи в таблице автоматически будет установлено текущее время и дата на момент вставки.
### Замечание 3:
NULL-поля: Поля, которые могут быть NULL:
   • name
   • email
   • gender
   • bday
   • postal_code
   • rating
Эти поля могут оставаться пустыми, если пользователь не желает делиться этой информацией.

---

## Задание 6
## Дополните таблицу, добавив данные двумя способами:
•	с помощью внесения данных вручную (как это было сделано ранее);
•	с помощью выполнения SQL-запросов ниже;
INSERT INTO `simpledb`.`users` (`name`, `email`, `postal_code`, `gender`, `bday`, `rating`) VALUES ('Ekaterina', 'ekaterina.petrova@outlook.com', '145789', 'f', '2000-02-11', '1.123');

INSERT INTO `simpledb`.`users` (`name`, `email`, `postal_code`, `gender`, `bday`, `rating`) VALUES ('Pяaul', 'paul@superpochta.ru', '123789', 'm', '1998-08-12', '1');

![code11](https://github.com/MelnikNO/DataBase/blob/main/screen/61.png)
![code11](https://github.com/MelnikNO/DataBase/blob/main/screen/62.png)
 
---

## Задание 7
## С помощью кнопки “Export recordset to external file” и получите файл с SQL-запросами (он будет экспортирован в формате .sql). Сохраните файл с SQL-запросами (в нем должно происходить добавление в таблицу данных),  проанализируйте синтаксис этих запросов и вставьте их в отчет.

### Решение:
Файл был сохранен и в нем содержался запрос:
>/*
-- Query: SELECT * FROM simpledb.users
LIMIT 0, 1000

-- Date: 2025-02-17 00:04
*/
INSERT INTO `` (`id`,`name`,`email`,`rating`,`gender`,`bday`,`postal_code`,`created`) VALUES (1,'robbit','rob333@example.com',NULL,NULL,NULL,NULL,NULL);
INSERT INTO `` (`id`,`name`,`email`,`rating`,`gender`,`bday`,`postal_code`,`created`) VALUES (2,'grid','grrriinch@example.com',NULL,NULL,NULL,NULL,NULL);
INSERT INTO `` (`id`,`name`,`email`,`rating`,`gender`,`bday`,`postal_code`,`created`) VALUES (3,'Ben','flaggg@exc.com',NULL,NULL,NULL,NULL,NULL);
INSERT INTO `` (`id`,`name`,`email`,`rating`,`gender`,`bday`,`postal_code`,`created`) VALUES (4,'Ekaterina','ekaterina.petrova@outlook.com',1.123,'F','2000-02-11','145789',NULL);
INSERT INTO `` (`id`,`name`,`email`,`rating`,`gender`,`bday`,`postal_code`,`created`) VALUES (5,'Pяaul','paul@superpochta.ru',1,'M','1998-08-12','123789',NULL);


***Анализ синтаксиса:***
1. INSERT INTO: Указывает, что мы будем добавлять данные в таблицу users.
2. (id, name, email, gender, bday, postal_code, rating, created): Список полей, в которые будут вставляться значения.
3. VALUES: Ключевое слово, за которым следует список значений для вставки.

---

## Задание 8
## Создайте еще одну таблицу с названием resume со следующей структурой:
•	resumeid, INT, PK, NN, AI
•	userid, INT, NN
•	title, VARCHAR(100), NN
•	skills, TEXT
•	created, TIMESTAMP, Default / Expression: CURRENT_TIMESTAMP()

При конструировании внизу во вкладке Foreign Keys определите так называемый внешний ключ (foreign key), который будет определять связь между текущей таблицей resume и уже созданной таблицей user.

Введите в таблицу слева в столбец Foreign Key (внешний ключ): userid и определите таблицу, где они будут находиться: simpledb.users

В таблицу Foreign key details ‘userid’ щелкните мышкой рядом с полем userid так, чтобы оно было выделено и определите столбец-источник для значений - id.
Последний шаг: определить действия при операциях On Update и On Delete: для  обоих выберите - Cascade.

Нажмите Apply и проанализируйте полученный SQL-запрос. Скопируйте полученный SQL-запрос в отчет по выполнению задания и опишите как будет вести себя СУБД при удалении связанных записей из таблиц users и resume.

### Решение:
**Запрос:**
ALTER TABLE `sys`.`resume` 
ADD CONSTRAINT `userid`
  FOREIGN KEY (`resumeid`)
  REFERENCES `simpledb`.`users` (`id`)
  ON DELETE CASCADE
  ON UPDATE CASCADE;

**Анализ:** Запрос обеспечивает связь между двумя таблицами и поддерживает целостность данных благодаря каскадным действиям при удалении и обновлении.
Поведения СУБД при удалении связанных записей:
•	Удаление записей из таблицы users: Все записи в таблице resume, которые имеют соответствующий userid, будут автоматически удалены. Это происходит благодаря установленному действию ON DELETE CASCADE.
•	Обновление записи в таблице users: Все записи в таблице resume, которые ссылаются на это значение через поле userid, будут автоматически обновлены. Это происходит благодаря установленному действию ON UPDATE CASCADE.

---

## Задание 9
Наполните вторую таблицу данными так, чтобы в ней была информация хотя бы о нескольких резюме, связанных с уже существующими пользователями из таблицы users. Подумайте и напишите в отчете, сколько резюме может быть у одного пользователя (минимум и максимум)?

С помощью кнопки “Export recordset to external file” сохраните файл с SQL-запросами добавления в таблицу данных, проанализируйте синтаксис этих запросов и вставьте их в отчет.

Попробуйте добавить в таблицу resume строчку с userid несуществующего пользователя (такого пользователя, id которого нет в таблице users).

Будет ли это возможно? Каков будет результат? Вставьте в отчет результат выполнения этого действия. Ответьте на эти вопросы и опишите полученный результат.

### Решение:
Минимум и максимум резюме у одного пользователя
• Минимум резюме: 0 резюме. Пользователь может не иметь ни одного резюме.
• Максимум резюме: Неограниченное количество резюме. В зависимости от бизнес-логики вашей системы и структуры базы данных, один пользователь может иметь любое количество резюме, если не установлены ограничения.

**Запрос:**
>/*
-- Query: SELECT * FROM sys.resume
LIMIT 0, 1000

-- Date: 2025-02-18 00:09
*/
INSERT INTO `` (`resumeid`,`userid`,`title`,`skills`,`created`) VALUES (2,1,'Software Engineer','Java, Spring, Hibernate','2025-02-18 00:05:05');
INSERT INTO `` (`resumeid`,`userid`,`title`,`skills`,`created`) VALUES (3,2,'Data Analyst','Python, SQL, Tableau','2025-02-18 00:05:05');
INSERT INTO `` (`resumeid`,`userid`,`title`,`skills`,`created`) VALUES (4,3,'Project Manager','Agile, Scrum, Leadership','2025-02-18 00:05:05');
INSERT INTO `` (`resumeid`,`userid`,`title`,`skills`,`created`) VALUES (5,4,'Web Developer','HTML, CSS, JavaScript','2025-02-18 00:05:05');


Попытка добавить резюме с несуществующим userid:
![code11](https://github.com/MelnikNO/DataBase/blob/main/screen/9.png)

Ожидаемый результат
При выполнении этого запроса MySQL выдаст ошибку, если в таблице users не существует пользователя с id = 999. Это связано с тем, что поле userid в таблице resume является внешним ключом (foreign key), ссылающимся на поле id в таблице users.
Результат:
>0	33	00:11:08	INSERT INTO resume (userid, title, skills) VALUES (999, 'Fake User Resume', 'Skill1, Skill2')	Error Code: 1452. Cannot add or update a child row: a foreign key constraint fails (`sys`.`resume`, CONSTRAINT `userid` FOREIGN KEY (`resumeid`) REFERENCES `simpledb`.`users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE)	0.000 sec

---

## Задание 10
Удалите одного или двух таких пользователей, что для них существуют записи в таблице resume. 
Это можно сделать в режиме Result Grid или Form Editor аналогично тому как вносятся изменения в записи таблицы.

Вставьте в отчет SQL-запросы, которые вы увидите после нажатия Apply. 
Что произойдет со связанными сущностями в таблице resume? Отразите ответ с комментариями в отчете.
Что произойдет, если в таблице users будет изменен id какого-то существующего пользователя. Отразите ответ и сделайте пояснение (скриншот) того, что произойдет.

### Решение:
**Запрос:**
>DELETE FROM `sys`.`resume` WHERE (`resumeid` = '5');

Что произойдет со связанными сущностями в таблице resume?
При удалении пользователей, для которых существуют записи в таблице resume, произойдут следующие действия:
•	Если в таблице resume установлено ограничение внешнего ключа (foreign key) на поле userid, то при попытке удаления пользователя с id = 1 или id = 2 будет выдана ошибка из-за нарушения ограничения целостности данных. Это связано с тем, что записи в таблице resume ссылаются на удаляемые userid.
ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails (database_name.resume, CONSTRAINT fk_userid FOREIGN KEY (userid) REFERENCES users (id))
•	Если же в таблице resume установлено поведение ON DELETE CASCADE, то при удалении пользователя также будут автоматически удалены все связанные записи в таблице resume.

Изменение id существующего пользователя:
Пример SQL-запроса для изменения id
UPDATE users SET id = 10 WHERE id = 3;
Что произойдет с записями в таблице resume?
Ошибка:
> 0	62	00:34:26	UPDATE users SET id = 10 WHERE id = 3	Error Code: 1146. Table 'sys.users' doesn't exist	0.000 sec

![code11](https://github.com/MelnikNO/DataBase/blob/main/screen/10.png)
